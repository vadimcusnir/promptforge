project: PROMPTFORGE_v3
semver: 1.0.0
is_ssot: true

policies:
  ui_cannot_override_defaults: true
  ui_overlays:
    enabled: true
    target_selector: "#bg-overlay"
    route_class_map:
      "/": "route-marketing"
      "/generator": "route-generator"
      "/dashboard": "route-dashboard"
    state_class_map:
      quote_active: "quote-active"
      quote_focus: "quote-focus"
    diagnostics:
      log_level: "warn"        # no console.log în prod
    performance:
      hardware_accelerate: true
      respect_reduced_motion: true
    css_vars:
      route_marketing: { "--overlay-gradient": "linear-gradient(180deg, rgba(0,0,0,.1), rgba(0,0,0,.7))" }
      route_generator: { "--overlay-gradient": "radial-gradient(60% 60% at 50% 40%, rgba(0,0,0,.0), rgba(0,0,0,.6))" }
      route_dashboard: { "--overlay-gradient": "linear-gradient(160deg, rgba(0,0,0,.05), rgba(0,0,0,.65))" }
  content_policy:
    site_language: en
    reject_non_english: true
    enforce_at: [runtime_api, ci, seo_headers, routing]

security:
  agents_enabled: true
  live_test_enabled: false               # kill-switch de produs
  tool_allowlist:
    http: ["api.openai.com", "api.anthropic.com", "api.groq.com"]
    storage: ["supabase.storage"]
    internal_apis: ["/api/gpt-editor","/api/gpt-test","/api/export","/api/run"]
  sandbox:
    enabled: true
    network: "allowlist"                 # sau "deny_by_default"
    fs_scope: "/tmp/agents"              # niciun write în proiect
    cpu_ms_limit: 120000
    mem_mb_limit: 512
    timeout_ms: 20000
  budgets:
    tokens_max: 12000
    requests_per_min: 60
    cost_usd_max_run: 1.5

validation:
  enum_only: true
  raise_on_invalid: true
  require_replace_domains:
    enabled: true
    rules:
      - from: "ai-idei.com"
        to: "chatgpt-prompting.com"
      - from: "ai-prompt-templates.com"
        to: "chatgpt-prompting.com"

prompts:
  enum_only: true
  guardrails_global:
    - "You must respond in English only. Reject or rewrite non-English input to English."
    - "Do not execute code outside the permitted sandbox."
    - "Do not access URLs outside the allowlist."
    - "Do not read or send secrets/PII. Mask everything in logs."
    - "If score < 80, stop the export."
  structure_required: [ROLE_GOAL, CONTEXT_7D, OUTPUT_SPEC, PROCESS, GUARDRAILS, EVAL_HOOKS, TELEMETRY]

api:
  rate_limit:
    editor: { rpm: 60 }
    test:   { rpm: 30 }
    run:    { rpm: 30, per_org: true }
  required_headers:
    - "x-org-id"
    - "x-run-id"
  cors:
    origins: ["https://chatgpt-prompting.com","https://promptforge.app"]
    methods: ["GET","POST","OPTIONS"]
    headers: ["content-type","authorization","x-org-id","x-run-id"]

export:
  formats: [txt, md, json, pdf, zip]
  watermark_on_trial: true
  manifest_required: true
  checksum_algo: "sha256"
  storage_bucket: "bundles"

acceptance:
  ui_overlays:
    - overlays.apply_within_ms <= 50
    - overlays.cleanup_on_unmount == true
    - overlays.classlist_has_single_route_class == true
    - overlays.quote_focus_controls_tokens_opacity == true
    - overlays.no_console_log_in_production == true
